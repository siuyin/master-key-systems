sequenceDiagram
  participant k as Key Program
  participant fs as File System
  participant ol as Offline Media
  k->>fs: Initialisation only: Write random bytes for master key material
  k->>fs: Read Master Key files and timestamp partials
  fs-->>k: Derive Master Key (KEK)
  k->>ol: During Initialisation only: Backup Master Key
  k->>k: Generate Data Encryption Key (DEK)
  k->>fs: Write encrypted DEK: KEK(DEK)

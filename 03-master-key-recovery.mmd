sequenceDiagram
  participant k as Key Program
  participant fs as File System
  participant ol as Offline Media
  ol->>k: Replace(KEK)
  k-->>fs: Read KEK(DEK)
  k->>k: Decrypt DEK with KEK
  k->>fs: Generate new Master Key Material
  k-->>fs: Read new Master Key Material for new KEK, KEK'
  k->>ol: Backup KEK'
  k->>fs: Write KEK'(DEK)
